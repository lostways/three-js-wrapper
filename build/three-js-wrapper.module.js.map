{"version":3,"file":"three-js-wrapper.module.js","sources":["../src/WrappedThree.js","../src/ThreeJSWrapper.js","../src/ThreeJSEntity.js"],"sourcesContent":["import * as THREE from \"three\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls.js\";\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader.js\";\n\n// Wrap our THREE instance\nconst WrappedThree = Object.assign({}, THREE, {\n  OrbitControls,\n  GLTFLoader,\n});\n\n// Export our wrapped THREE instance\nexport default WrappedThree;\n","import THREE from \"./WrappedThree.js\";\n\nexport default class ThreeJSWrapper {\n  //constructor\n  // @param {HTMLCanvasElement} canvas - The canvas element to render to\n  constructor(canvas) {\n    if (!(canvas && typeof canvas === \"object\")) {\n      throw new Error(\"canvas is required to construct wrapper\");\n    }\n\n    //canvas\n    this.canvas = canvas;\n\n    //dimensions\n    this.dimensions = {\n      width: canvas.width,\n      height: canvas.height,\n    };\n\n    //camera\n    this.camera = this.buildCamera();\n\n    //scene\n    this.scene = new THREE.Scene();\n\n    //renderer\n    this.renderer = this.buildRenderer();\n\n    //controls\n    this.controls = new WrappedThree.OrbitControls(\n      this.camera,\n      this.renderer.domElement\n    );\n\n    //loader\n    this.loader = new WrappedThree.GLTFLoader();\n\n    //clock\n    this.clock = new THREE.Clock();\n\n    //running flag\n    this.isRunning = false;\n  }\n\n  //static THREE instance\n  static get THREE() {\n    return THREE;\n  }\n\n  //add an entity to the scene\n  // @param {ThreeJSEntity} entity - The entity to add\n  addEntity(entity) {\n    this.scene.add(entity.object3d);\n  }\n\n  //remove en entity from the scene\n  // @param {ThreeJSEntity} entity - The entity to remove\n  removeEntity(entity) {\n    if (\n      !(\n        entity &&\n        typeof entity === \"object\" &&\n        entity.object3d instanceof THREE.Object3D\n      )\n    ) {\n      throw new Error(\"Can't remove invalid ThreeJSEntity\");\n    }\n\n    if (!this.scene.children.includes(entity.object3d)) {\n      throw new Error(\"Can't remove entity that is not in scene\");\n    }\n\n    let object3d = entity.object3d;\n\n    if (object3d instanceof THREE.Mesh) {\n      if (object3d.geometry) {\n        object3d.geometry.dispose();\n      }\n\n      if (object3d.material) {\n        if (object3d.material instanceof Array) {\n          object3d.material.forEach((material) => material.dispose());\n        } else {\n          object3d.material.dispose();\n        }\n      }\n    }\n\n    this.scene.remove(entity.object3d);\n  }\n\n  //start the animation loop\n  start() {\n    this.resize();\n    this.bindEventListeners();\n    this.render();\n    this.loop();\n    this.isRunning = true;\n  }\n\n  //render the scene\n  render() {\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  //update the scene animation\n  update() {\n    let delta = this.clock.getDelta();\n    this.scene.children.forEach((ent) => {\n      ent.dispatchEvent({ type: \"update\", delta: delta });\n    });\n  }\n\n  //the animation loop\n  loop() {\n    requestAnimationFrame(this.loop.bind(this));\n    this.update();\n    this.render();\n  }\n\n  //resize the scene to the current canvas size\n  resize() {\n    this.fullscreen();\n\n    let { width, height } = this.canvas;\n\n    this.dimensions.width = width;\n    this.dimensions.height = height;\n\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n\n    this.renderer.setSize(width, height);\n  }\n\n  //fullscreen the canvas\n  fullscreen() {\n    this.canvas.style.width = \"100%\";\n    this.canvas.style.height = \"100%\";\n\n    this.canvas.width = this.canvas.offsetWidth;\n    this.canvas.height = this.canvas.offsetHeight;\n  }\n\n  //event listeners\n  bindEventListeners() {\n    window.onresize = this.resize.bind(this);\n  }\n\n  //build our three js renderer\n  // @returns {THREE.WebGLRenderer} - The renderer\n  buildRenderer() {\n    let { width, height } = this.dimensions;\n    let renderer = new THREE.WebGLRenderer({ canvas: this.canvas });\n    renderer.setSize(width, height);\n    return renderer;\n  }\n\n  //build our camera\n  // @returns {THREE.PerspectiveCamera} - The camera\n  buildCamera() {\n    let { width, height } = this.dimensions;\n    let fov = 75;\n    let aspect = width / height;\n    let near = 0.1;\n    let far = 1000;\n\n    return new THREE.PerspectiveCamera(fov, aspect, near, far);\n  }\n}\n","// src/ThreeJSEntity.js\nimport ThreeJSWrapper from \"./ThreeJSWrapper.js\";\n\n//Entity base class\nexport default class ThreeJSEntity {\n  constructor(params = {}) {\n    this.params = params;\n    this.THREE = ThreeJSWrapper.THREE;\n    this.object3d = this.create();\n    this.object3d.addEventListener(\"update\", this.update.bind(this));\n  }\n\n  /**\n   * Override to create Object3D\n   */\n  create() {\n    throw new Error(\"Entities must have a create method\");\n  }\n\n  /**\n   * Override to define animations\n   * @param {Object} event - Update event containing delta time\n   */\n  update(event) {}\n}\n"],"names":["WrappedThree","THREE"],"mappings":"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"}